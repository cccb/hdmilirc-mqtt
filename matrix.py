
import serial

import time



GET_INPUT_PAYLOAD = b'\xA5\x5B\x02\x01\x01\x00\x00\x00\x00\x00\x00\x00\xFC'
GET_AUDIO_PAYLOAD = b'\xA5\x5B\x01\x0C\x01\x00\x00\x00\x00\x00\x00\x00\xF2'

SET_INPUT_0_PAYLOAD = b'\xA5\x5B\x02\x03\x01\x00\x01\x00\x00\x00\x00\x00\xF9'
SET_INPUT_1_PAYLOAD = b'\xA5\x5B\x02\x03\x02\x00\x01\x00\x00\x00\x00\x00\xF8'
SET_INPUT_2_PAYLOAD = b'\xA5\x5B\x02\x03\x03\x00\x01\x00\x00\x00\x00\x00\xF7'
SET_INPUT_3_PAYLOAD = b'\xA5\x5B\x02\x03\x04\x00\x01\x00\x00\x00\x00\x00\xF6'

SET_AUDIO_0_PAYLOAD = b'\xA5\x5B\x03\x02\x01\x00\x01\x00\x00\x00\x00\x00\xF9'
SET_AUDIO_1_PAYLOAD = b'\xA5\x5B\x03\x02\x02\x00\x01\x00\x00\x00\x00\x00\xF8'
SET_AUDIO_2_PAYLOAD = b'\xA5\x5B\x03\x02\x03\x00\x01\x00\x00\x00\x00\x00\xF7'
SET_AUDIO_3_PAYLOAD = b'\xA5\x5B\x03\x02\x04\x00\x01\x00\x00\x00\x00\x00\xF6'

GET_INPUT_0_PAYLOAD = b'\xA5\x5B\x01\x04\x01\x00\x00\x00\x00\x00\x00\x00\xFA'
GET_INPUT_1_PAYLOAD = b'\xA5\x5B\x01\x04\x02\x00\x00\x00\x00\x00\x00\x00\xF9'
GET_INPUT_2_PAYLOAD = b'\xA5\x5B\x01\x04\x03\x00\x00\x00\x00\x00\x00\x00\xF8'
GET_INPUT_3_PAYLOAD = b'\xA5\x5B\x01\x04\x04\x00\x00\x00\x00\x00\x00\x00\xF7'

GET_OUTPUT_PAYLOAD = b'\xA5\x5B\x01\x05\x01\x00\x00\x00\x00\x00\x00\x00\xF9'

GET_AUTO_SWITCH_PAYLOAD = b'\xA5\x5B\x01\x0D\x00\x00\x00\x00\x00\x00\x00\x00\xF2'

SET_AUTO_SWITCH_ON = b'\xA5\x5B\x02\x05\x0F\x00\x00\x00\x00\x00\x00\x00\xEA'
SET_AUTO_SWITCH_OFF = b'\xA5\x5B\x02\x05\xF0\x00\x00\x00\x00\x00\x00\x00\x09'


def request(conn, payload, response_len=13):
    print(conn.write(payload[:1]))
    time.sleep(0.001)
    print(conn.write(payload[1:]))

    return conn.read(response_len)


def selected_source(conn):
    response = request(conn, GET_INPUT_PAYLOAD)
    val = response[-1]

    return 251 - val


def selected_audio(conn):
    response = request(conn, GET_AUDIO_PAYLOAD);
    val = response[-1]

    return 241 - val


def selected_foo(conn):
    response = request(conn,
                       b"\xA5\x5B\x01\x0D\x00\x00\x00\x00\x00\x00\x00\x00\xF2")
    val = response[-1]

    return response


def selected_bar(conn):
    response = request(conn,
                       b"\xA5\x5B\x01\x02\x00\x00\x01\x00\x00\x00\x00\x00\xED")
    val = response[-1]

    return response


# Responses:
AUTO_OFF = b'\xa5[\x01\r\xf0\x00\x00\x00\x00\x00\x00\x00\x02'
AUTO_ON = b'\xa5[\x01\r\x0f\x00\x00\x00\x00\x00\x00\x00\xe3'

INPUT_0_DISCONNECTED = b'\xa5[\x01\x04\x01\x00\xff\x00\x00\x00\x00\x00\xfb'
INPUT_0_CONNECTED = b'\xa5[\x01\x04\x01\x00\x00\x00\x00\x00\x00\x00\xfa'

INPUT_1_DISCONNECTED = b'\xa5[\x01\x04\x02\x00\xff\x00\x00\x00\x00\x00\xfa'
INPUT_1_CONNECTED = b'\xa5[\x01\x04\x02\x00\x00\x00\x00\x00\x00\x00\xf9'

